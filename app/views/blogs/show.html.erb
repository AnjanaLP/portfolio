<div class="col-sm-8 blog-main">

  <h2><%= @blog.title %></h2>

  <nav class="breadcrumb row">
    <div class="col">
      <%= link_to "Home", root_path, class: 'breadcrumb-item' %>
      <%= link_to "Blog", blogs_path, class: 'breadcrumb-item' %>
      <%= link_to @blog.topic.title, topic_path(@blog.topic), class: 'breadcrumb-item' %>
      <span class="breadcrumb-item active"><%= @blog.title %></span>

      <span class="float-right">
        <%= link_to fa_icon('edit'), edit_blog_path(@blog), class: "btn btn-sm btn-primary" if logged_in?(:site_admin) %>
        <%= link_to fa_icon('trash'), @blog, method: :delete, data: { confirm: 'Are you sure you want to delete this post' },
                                                              class: "btn btn-sm btn-danger" if logged_in?(:site_admin) %>
      </span>
    </div>
  </nav>
  <p>
    <%= @blog.body %>
  </p>

  <div class="comment-form">
    <% if current_user.is_a? GuestUser %>
      <%= link_to "Login to post a comment", new_user_session_path, class: "btn btn-primary" %>
    <% else %>
      <div>
        <%= form_for @comment do |f| %>
          <div class="form-group">

            <%= f.text_area :content, class: "form-control", placeholder: "Write a comment...", rows: 5 %>
            <%= f.hidden_field(:blog_id, value: @blog.id) %>
          </div>

          <div class="form-group">
            <%= f.submit 'Post comment', class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>

  <% if @blog.comments.any? %>
    <div>
      <h5>Comments:</h5>
        <% @blog.comments.each do |comment| %>
          <span class="user-icons text-primary"><%= fa_icon "user" %></span>
          <em>Posted by <%= comment.user.name %> <%= time_ago_in_words(comment.created_at) %> ago</em>
          <p><%= comment.content %></p><hr>
        <% end %>
    </div>
  <% end %>
</div>
